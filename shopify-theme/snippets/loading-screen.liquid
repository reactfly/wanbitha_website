{%- comment -%} Loading Screen (Hero Style & Progressive Reveal v3) {%- endcomment -%}
<style>
  #loadingScreen {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    background: radial-gradient(ellipse at center, #0a0015 0%, #000 100%);
    z-index: 2147483647 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    transition: visibility 0.8s ease;
    cursor: wait;
    overflow: hidden;
  }

  #loadingRing {
    position: absolute;
    width: clamp(200px, 40vw, 400px);
    height: clamp(200px, 40vw, 400px);
    border-radius: 50%;
    border: 1px solid rgba(255, 0, 128, 0.15);
    animation: loadRingSpin 8s linear infinite, loadRingPulse 3s ease-in-out infinite;
  }

  #loadingRing::before {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: 50%;
    border: 2px solid transparent;
    border-top-color: #ff0080;
    border-right-color: #c084fc;
    animation: loadRingSpin 3s linear infinite;
    filter: drop-shadow(0 0 8px rgba(255, 0, 128, 0.5));
  }

  @keyframes loadRingSpin {
    to {
      transform: rotate(360deg);
    }
  }
  @keyframes loadRingPulse {
    0%,
    100% {
      transform: scale(1);
      opacity: 0.5;
    }
    50% {
      transform: scale(1.08);
      opacity: 1;
    }
  }

  #loadingCounter {
    position: relative;
    z-index: 2;
    font-family: var(--font-display), 'Times New Roman', serif !important;
    font-size: clamp(72px, 14vw, 220px) !important;
    color: #fff !important;
    font-weight: 300 !important;
    line-height: 1 !important;
    letter-spacing: -0.04em !important;
    text-shadow: 0 0 30px rgba(255, 0, 128, 0.4), 0 0 60px rgba(192, 132, 252, 0.2), 0 0 100px rgba(255, 255, 255, 0.15) !important;
    opacity: 1;
    transform: scale(1);
    transition: transform 1.4s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.6s ease, filter 0.6s ease;
    font-variant-numeric: tabular-nums;
  }

  #loadingScreen.is-zoom-out #loadingCounter {
    transform: scale(6) !important;
    opacity: 0 !important;
    filter: blur(30px);
  }

  #loadingScreen.is-zoom-out #loadingRing {
    transform: scale(3) !important;
    opacity: 0 !important;
    transition: all 1s cubic-bezier(0.16, 1, 0.3, 1);
  }

  #loadingScreen.is-finished {
    opacity: 0 !important;
    visibility: hidden !important;
    pointer-events: none !important;
  }
</style>

<div id="loadingScreen">
  <div id="loadingRing"></div>
  <div id="loadingCounter">0</div>
</div>

<script>
  (function () {
    var count = 0;
    var el = document.getElementById('loadingCounter');
    var screen = document.getElementById('loadingScreen');
    var ring = document.getElementById('loadingRing');

    document.documentElement.style.setProperty('overflow', 'hidden', 'important');
    document.body.style.setProperty('overflow', 'hidden', 'important');

    function update() {
      var increment = Math.floor(Math.random() * 3) + 1;
      count += increment;
      if (count > 100) count = 100;

      if (el) el.innerText = count;

      // Progressive background fade
      if (screen) {
        var opacity = Math.max(0.02, 1 - count / 110);
        screen.style.background =
          'radial-gradient(ellipse at center, rgba(10,0,21,' + opacity + ') 0%, rgba(0,0,0,' + opacity + ') 100%)';
      }

      // Ring glow intensifies with progress
      if (ring) {
        var glow = (count / 100) * 20;
        ring.style.boxShadow =
          '0 0 ' +
          glow +
          'px rgba(255,0,128,' +
          count / 200 +
          '), inset 0 0 ' +
          glow * 0.5 +
          'px rgba(192,132,252,' +
          count / 300 +
          ')';
      }

      if (count < 100) {
        requestAnimationFrame(function () {
          setTimeout(update, Math.random() * 55 + 25);
        });
      } else {
        setTimeout(function () {
          if (screen) screen.classList.add('is-zoom-out');
          setTimeout(function () {
            if (screen) screen.classList.add('is-finished');
            document.documentElement.style.overflow = '';
            document.body.style.overflow = '';
            window.dispatchEvent(new CustomEvent('loadingComplete'));
          }, 900);
        }, 400);
      }
    }

    requestAnimationFrame(function () {
      update();
    });
  })();
</script>
